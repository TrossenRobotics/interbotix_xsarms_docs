<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Joystick Control &mdash; Interbotix X-Series Arms Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tr_style.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Record And Playback" href="record_and_playback.html" />
    <link rel="prev" title="MATLAB Demos" href="matlab_demos.html" />
   
  <!-- Google Tag Manager (noscript) -->
  <noscript>
    <iframe
    src="https://www.googletagmanager.com/ns.html?id=GTM-PZQLS2V"
    height="0"
    width="0"
    style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  <!-- End Google Tag Manager (noscript) -->

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo_xsarms.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../specifications/index.html">Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ros_interface/index.html">ROS Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_ros_interface/index.html">Python-ROS Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab_ros_interface/index.html">MATLAB-ROS Interface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ROS Open Source Packages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arm_descriptions.html">Arm Descriptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="arm_control.html">Arm Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="gazebo_simulation_configuration.html">Gazebo Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="ros_control.html">ROS Controllers Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_motion_planning_configuration.html">MoveIt Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="perception_pipeline_configuration.html">Perception Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_interface_and_api.html">MoveIt Interface and API</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_demos.html">Python Demos</a></li>
<li class="toctree-l2"><a class="reference internal" href="matlab_demos.html">MATLAB Demos</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Joystick Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#video-tutorials">Video Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-a-joystick-to-control-x-series-arms">Using a Joystick to Control X-Series Arms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#joystick-x-series-arm-demo">Joystick X-Series Arm Demo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="record_and_playback.html">Record And Playback</a></li>
<li class="toctree-l2"><a class="reference internal" href="arm_diagnostic_tool.html">Arm Diagnostic Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="arm_diagnostic_listener.html">Arm Diagnostic Listener</a></li>
<li class="toctree-l2"><a class="reference internal" href="pid_gains_test_environment.html">PID Gains Test Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="arm_puppeteering.html">Arm Puppeteering</a></li>
<li class="toctree-l2"><a class="reference internal" href="dual_arm_control.html">Dual Arm Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="dual_arm_joystick_control.html">Dual Arm Joystick Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#contributing">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ros2_packages/index.html">ROS 2 Open Source Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Interbotix X-Series Manipulators Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">ROS Open Source Packages</a></li>
      <li class="breadcrumb-item active">Joystick Control</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/TrossenRobotics/interbotix_xsarms_docs/blob/main/ros_packages/joystick_control.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="joystick-control">
<h1>Joystick Control<a class="headerlink" href="#joystick-control" title="Permalink to this headline"></a></h1>
<a
href="https://github.com/Interbotix/interbotix_ros_manipulators/tree/main/interbotix_ros_xsarms/examples/interbotix_xsarm_joy"
        class="docs-view-on-github-button" target="_blank"> <img
        src="../_static/GitHub-Mark-Light-32px.png"
                class="docs-view-on-github-button-gh-logo">
        View Package on GitHub
</a><div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>This package can be used to control the movements of any X-Series robotic arm using a SONY PS3/PS4
controller or Microsoft Xbox360 controller (untested) via Bluetooth. In this demo, the ‘arm’ joints
are set to work in ‘position’ control mode while the gripper operates in ‘PWM’ mode. Refer to the
joystick button map below to see how to operate the robot. Specifically, some of the joystick
controls manipulate individual joints while others are used to perform ‘inverse kinematics’ on all
the joints to get the end-effector of the robot (defined at ‘ee_gripper_link’) to move as if it’s
in Cartesian space. This is done using the <a class="reference external" href="https://github.com/NxRLab/ModernRobotics/tree/master/packages/Python" rel="noopener noreferrer" target="_blank">modern_robotics</a> code library offered by Northwestern
University.</p>
</div>
<div class="section" id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Permalink to this headline"></a></h2>
<img alt="../_images/xsarm_joy_flowchart.png" class="align-center" src="../_images/xsarm_joy_flowchart.png" style="width: 70%;" />
<p>As shown above, the <cite>interbotix_xsarm_joy</cite> package builds on top of the <cite>interbotix_xsarm_control</cite>
package. To get pointers about the nodes in that package, please look at its README. The other
nodes are described below:</p>
<ul class="simple">
<li><strong>joy</strong> - a ROS driver for a generic Linux joystick; it reads data from a joystick over
Bluetooth and publishes <a class="reference external" href="http://docs.ros.org/melodic/api/sensor_msgs/html/msg/Joy.html" rel="noopener noreferrer" target="_blank">sensor_msgs/Joy</a> messages to the <code class="docutils literal notranslate"><span class="pre">commands/joy_raw</span></code> topic</li>
<li><strong>xsarm_joy</strong> - responsible for reading in raw <a class="reference external" href="http://docs.ros.org/melodic/api/sensor_msgs/html/msg/Joy.html" rel="noopener noreferrer" target="_blank">sensor_msgs/Joy</a> messages from the
<code class="docutils literal notranslate"><span class="pre">commands/joy_raw</span></code> topic and converting them into <a class="reference external" href="https://github.com/Interbotix/interbotix_ros_core/blob/main/interbotix_ros_xseries/interbotix_xs_msgs/msg/ArmJoy.msg" rel="noopener noreferrer" target="_blank">ArmJoy</a> messages; this makes the code
more readable and allows users to remap buttons very easily later.</li>
<li><strong>xsarm_robot</strong> - responsible for reading in <a class="reference external" href="https://github.com/Interbotix/interbotix_ros_core/blob/main/interbotix_ros_xseries/interbotix_xs_msgs/msg/ArmJoy.msg" rel="noopener noreferrer" target="_blank">ArmJoy</a> messages and sending joint and gripper
commands to the <strong>xs_sdk</strong> node; while the ‘waist’ joint can be directly controlled via the
PS3/PS4 joystick, other buttons allow position-ik to be performed using all the arm joints.</li>
</ul>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline"></a></h2>
<p>After pairing your Bluetooth joystick controller using the <a class="reference internal" href="../getting_started/pairing_controller.html"><span class="doc">Pairing Your Controller</span></a> Guide, type the following in a terminal (let’s say to
control the WidowX-200 arm):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>roslaunch interbotix_xsarm_joy xsarm_joy.launch robot_model:<span class="o">=</span>wx200
</pre></div>
</div>
<p>A red error message might appear in the screen saying <code class="docutils literal notranslate"><span class="pre">Couldn't</span> <span class="pre">open</span> <span class="pre">joystick</span> <span class="pre">force</span> <span class="pre">feedback!</span></code>.
This is normal and will not affect the joystick operation. To further customize the launch file at
run-time, look at the table below:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="20%" />
<col width="60%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
<th class="head">Default Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>robot_model</td>
<td>model type of the Interbotix Arm such as ‘wx200’ or ‘rx150’</td>
<td>“”</td>
</tr>
<tr class="row-odd"><td>robot_name</td>
<td>name of the robot (typically equal to robot_model, but could be anything)</td>
<td>$(arg robot_model)</td>
</tr>
<tr class="row-even"><td>base_link_frame</td>
<td>name of the ‘root’ link on the arm; typically ‘base_link’, but can be changed if attaching the arm to a mobile base that already has a ‘base_link’ frame</td>
<td>base_link’</td>
</tr>
<tr class="row-odd"><td>use_rviz</td>
<td>launches RViz</td>
<td>true</td>
</tr>
<tr class="row-even"><td>mode_configs</td>
<td>the file path to the ‘mode config’ YAML file</td>
<td>refer to <a class="reference external" href="https://github.com/Interbotix/interbotix_ros_manipulators/blob/main/interbotix_ros_xsarms/examples/interbotix_xsarm_joy/launch/xsarm_control.launch" rel="noopener noreferrer" target="_blank">xsarm_control.launch</a></td>
</tr>
<tr class="row-odd"><td>threshold</td>
<td>value from 0 to 1 defining joystick sensitivity; a larger number means the joystick should be less sensitive</td>
<td>0.75</td>
</tr>
<tr class="row-even"><td>controller</td>
<td>type of controller (‘ps3’, ‘ps4’, or ‘xbox360’)</td>
<td>ps4</td>
</tr>
<tr class="row-odd"><td>launch_driver</td>
<td>true if the xsarm_control.launch file should be launched - set to false if you would like to run your own version of this file separately</td>
<td>true</td>
</tr>
<tr class="row-even"><td>use_sim</td>
<td>if true, the Dynamixel simulator node is run; use RViz to visualize the robot’s motion; if false, the real Dynamixel driver node is run</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>To understand how the joystick buttons map to controlling the robot, look at the diagram and table
below. Note that while the Xbox360 has a slightly different naming convention, the button placement
is essentially the same:</p>
<img alt="../_images/ps3.jpg" class="align-center" src="../_images/ps3.jpg" style="width: 70%;" />
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Button</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>START/OPTIONS</td>
<td>move robot arm to its Home pose</td>
</tr>
<tr class="row-odd"><td>SELECT/SHARE</td>
<td>move robot arm to its Sleep pose</td>
</tr>
<tr class="row-even"><td>R2</td>
<td>rotate the ‘waist’ joint clockwise</td>
</tr>
<tr class="row-odd"><td>L2</td>
<td>rotate the ‘waist’ joint counterclockwise</td>
</tr>
<tr class="row-even"><td>Triangle</td>
<td>increase gripper pressure in 0.125 step increments (max is 1)</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>decrease gripper pressure in 0.125 step increments (min is 0)</td>
</tr>
<tr class="row-even"><td>O</td>
<td>open gripper</td>
</tr>
<tr class="row-odd"><td>Square</td>
<td>close gripper</td>
</tr>
<tr class="row-even"><td>D-pad Up</td>
<td>increase the control loop rate in 1 Hz step increments (max of 40)</td>
</tr>
<tr class="row-odd"><td>D-pad Down</td>
<td>decrease the control loop rate in 1 Hz step increments (min of 10)</td>
</tr>
<tr class="row-even"><td>D-pad Left</td>
<td>coarse’ control - sets the control loop rate to a user-preset ‘fast’ rate</td>
</tr>
<tr class="row-odd"><td>D-pad Right</td>
<td>fine’ control - sets the control loop rate to a user-preset ‘slow’ rate</td>
</tr>
<tr class="row-even"><td>Right stick Up/Down</td>
<td>increase/decrease pitch of the end-effector</td>
</tr>
<tr class="row-odd"><td>Right stick Left/Right</td>
<td>increase/decrease roll of the end-effector</td>
</tr>
<tr class="row-even"><td>R3</td>
<td>reverses the Right stick Left/Right control</td>
</tr>
<tr class="row-odd"><td>Left stick Up/Down</td>
<td>move the end-effector (defined at ‘ee_gripper_link’) vertically in Cartesian space</td>
</tr>
<tr class="row-even"><td>Left stick Left/Right</td>
<td>move the end-effector (defined at ‘ee_gripper_link’) horizontally in Cartesian space</td>
</tr>
<tr class="row-odd"><td>L3</td>
<td>reverses the Left stick Left/Right control</td>
</tr>
<tr class="row-even"><td>R1</td>
<td>if the arm has 6dof, this moves the end-effector in a negative direction along its own ‘y’ axis</td>
</tr>
<tr class="row-odd"><td>L1</td>
<td>if the arm has 6dof, this moves the end-effector in a positive direction along its own ‘y’ axis</td>
</tr>
<tr class="row-even"><td>PS</td>
<td>if torqued on, holding for 3 seconds will torque off the robot; if torqued off, tapping the button will torque on the robot</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="video-tutorials">
<h2>Video Tutorials<a class="headerlink" href="#video-tutorials" title="Permalink to this headline"></a></h2>
<div class="section" id="using-a-joystick-to-control-x-series-arms">
<h3>Using a Joystick to Control X-Series Arms<a class="headerlink" href="#using-a-joystick-to-control-x-series-arms" title="Permalink to this headline"></a></h3>
<div class="video_wrapper align-center" style="padding-bottom: 22.500000%; padding-top: 30px; position: relative; text-align: center; width: 40%">
<iframe allowfullscreen="true" src="https://www.youtube.com/embed/AyKjcZvu8lo" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%">
</iframe></div><div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="joystick-x-series-arm-demo">
<h3>Joystick X-Series Arm Demo<a class="headerlink" href="#joystick-x-series-arm-demo" title="Permalink to this headline"></a></h3>
<div class="video_wrapper align-center" style="padding-bottom: 22.500000%; padding-top: 30px; position: relative; text-align: center; width: 40%">
<iframe allowfullscreen="true" src="https://www.youtube.com/embed/IkqDeMSHu-k" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%">
</iframe></div></div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="matlab_demos.html" class="btn btn-neutral float-left" title="MATLAB Demos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="record_and_playback.html" class="btn btn-neutral float-right" title="Record And Playback" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Trossen Robotics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
    <!-- Socials -->
     


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>